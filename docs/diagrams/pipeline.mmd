flowchart LR
  %% =============================
  %% USER / CLI ENTRY
  %% =============================
  A["User / CI\n(spectramind CLI)"] --> B["Hydra Configs\n(env, data, calib, model, loss, training)"]

  %% =============================
  %% PIPELINE STAGES
  %% =============================
  B --> C["Calibrate\n(raw → calibrated)"]
  C --> D["Preprocess\n(calibrated → tensors)"]
  D --> E["Train\n(tensors → checkpoints)"]
  E --> F["Predict\n(checkpoints → μ, σ)"]
  F --> G["Diagnose\n(inject-&-recover, HTML dashboard)"]
  F --> H["Submit\n(package, schema validate, zip/json)"]

  %% =============================
  %% ARTIFACTS & STORAGE
  %% =============================
  C -. DVC tracked .-> Z["data/interim/calibrated/"]
  D -. DVC tracked .-> Y["data/processed/tensors/"]
  E -. checkpoints .-> X["artifacts/checkpoints/model.ckpt"]
  F -. preds .-> W["artifacts/predictions/{mu.csv,sigma.csv}"]
  G -. report .-> V["artifacts/reports/diagnostics_dashboard.html"]
  H -. submission .-> U["dist/submission.{zip,json,csv}"]

  %% =============================
  %% REMOTE CACHE
  %% =============================
  Z -.-> R["DVC Remote (local/S3/SSH)"]
  Y -.-> R
  X -.-> R
  W -.-> R
