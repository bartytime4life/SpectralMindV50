flowchart LR
  %% =============================
  %% USER / CLI ENTRY
  %% =============================
  A["User / CI<br/>(spectramind CLI)"] --> B["Hydra Configs<br/>(env, data, calib, model, loss, training)"]

  %% =============================
  %% PIPELINE STAGES
  %% =============================
  B --> C["Calibrate<br/>(raw → calibrated)"]
  C --> D["Preprocess<br/>(calibrated → tensors)"]
  D --> E["Train<br/>(tensors → checkpoints)"]
  E --> F["Predict<br/>(checkpoints → μ, σ)"]
  F --> G["Diagnose<br/>(inject-&-recover, HTML dashboard)"]
  F --> H["Submit<br/>(package, schema validate, zip/json)"]

  %% =============================
  %% ARTIFACTS & STORAGE
  %% =============================
  C -.-> Z["data/interim/calibrated/ (DVC)"]
  D -.-> Y["data/processed/tensors/ (DVC)"]
  E -.-> X["artifacts/checkpoints/model.ckpt"]
  F -.-> W["artifacts/predictions/{mu.csv,sigma.csv}"]
  G -.-> V["artifacts/reports/diagnostics_dashboard.html"]
  H -.-> U["dist/submission.{zip,json,csv}"]

  %% =============================
  %% REMOTE CACHE
  %% =============================
  Z -.-> R["DVC Remote<br/>(local/S3/SSH)"]
  Y -.-> R
  X -.-> R
  W -.-> R
